<nav class="navbar">
    <div class="container">
        <a href="/" class="navbar-brand">YEAH<span>TURF!</span></a>
        
        <div class="nav-links">
            <a href="/">Home</a>
            <a href="/games">Find Games</a>
            <a href="/players">Find Players</a>
            
            <div id="guest-links" style="display: none;">
                <a href="/login" class="btn-secondary" style="padding: 5px 15px; border-radius: 5px;">Login</a>
                <a href="/signup" class="btn" style="padding: 5px 15px; margin-left: 5px;">Sign Up</a>
            </div>
            
            <div id="user-links" style="display: none; align-items: center; gap: 10px;">
                <span id="nav-email" style="font-size: 0.9rem; font-weight: bold; color: var(--primary-color);"></span>
                <button id="logout-btn" class="btn-secondary" style="padding: 5px 10px; font-size: 0.8rem; border: 1px solid #ef4444; color: #ef4444; background: transparent; cursor: pointer;">Logout</button>
            </div>
        </div>
    </div>
</nav>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // --- YOUR FIREBASE CONFIG ---
    const firebaseConfig = {
        apiKey: "AIzaSyAgcCQVw7uupQr0FSMwyaLRLQRcus1ss3g",
        authDomain: "yeahturf-4cb5e.firebaseapp.com",
        projectId: "yeahturf-4cb5e",
        storageBucket: "yeahturf-4cb5e.firebasestorage.app",
        messagingSenderId: "1068687401138",
        appId: "1:1068687401138:web:1791b74bfa77d64eb969ab"
    };

    // Initialize Firebase (safely check if already initialized)
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Elements to toggle
    const guestLinks = document.getElementById('guest-links');
    const userLinks = document.getElementById('user-links');
    const navEmail = document.getElementById('nav-email');
    const logoutBtn = document.getElementById('logout-btn');

    // 1. Listen for Login/Logout events
    onAuthStateChanged(auth, (user) => {
        if (user) {
            // User is signed in
            if (guestLinks) guestLinks.style.display = 'none';
            if (userLinks) userLinks.style.display = 'flex';
            if (navEmail) navEmail.textContent = user.email.split('@')[0]; // Show name part of email
        } else {
            // User is signed out
            if (userLinks) userLinks.style.display = 'none';
            if (guestLinks) guestLinks.style.display = 'inline-block';
        }
    });

    // 2. Handle Logout Click
    if(logoutBtn) {
        logoutBtn.addEventListener('click', () => {
            signOut(auth).then(() => {
                window.location.href = '/login'; // Redirect to login after logout
            });
        });
    }

    // Share auth object globally so other scripts (like Create Game) can use it
    window.auth = auth; 
</script>